{% extends 'empresa/base.html' %}
{% load static %}
{% load svg_tags %}

{% block title %}{{ empresa.nombre|default:"TK REDLINE SPA" }} - Soluciones Eficientes en Ingeniería{% endblock %}

{% block extra_css %}
{{ block.super }}
{% endblock %}

{% block extra_js %}
{{ block.super }}
<script>
document.addEventListener('DOMContentLoaded', function () {
    const track = document.querySelector('.logo-track');
    if (!track) {
        return;
    }
    track.innerHTML = track.innerHTML + track.innerHTML;
});
</script>
{% endblock %}

{% block content %}
<!-- Hero Section -->
<section class="bg-gradient-to-br from-base-200 to-base-300 text-base-content py-16 md:py-20 relative overflow-hidden min-h-[360px] md:min-h-[460px] {% if empresa and empresa.imagen_fondo_hero or configuracion and configuracion.fondo_global %} from-transparent to-transparent bg-none {% endif %}" style="margin-top: 64px;">
    {% if empresa and empresa.imagen_fondo_hero %}
    <div class="absolute inset-0 z-0">
        <img src="{{ empresa.imagen_fondo_hero.url }}" alt="Fondo TEKON" class="w-full h-full object-cover opacity-90 hero-bg-image">
    </div>
    {% elif configuracion and configuracion.fondo_global %}
    <div class="absolute inset-0 z-0">
        <img src="{{ configuracion.fondo_global.url }}" alt="Fondo TEKON" class="w-full h-full object-cover hero-bg-image">
    </div>
    {% endif %}
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 relative z-10">
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-12 items-center">
            <div class="space-y-8">
                <div class="space-y-4">
                    <h1 class="text-5xl lg:text-6xl font-bold leading-tight">
                        <span class="text-primary">SOLUCIONES</span><br>
                        <span class="text-base-content">EFICIENTES</span>
                    </h1>
                    <div class="w-20 h-1 bg-primary"></div>
                </div>
                <p class="text-xl text-base-content/70 leading-relaxed">
                    {% if empresa %}
                        {{ empresa.descripcion }}
                    {% else %}
                        Especializados en la prestación de servicios generales para el desarrollo de proyectos de ingeniería, construcción, supervisión, fiscalización y capacitación de personal.
                    {% endif %}
                </p>
                <div class="flex flex-col sm:flex-row gap-4">
                    <a href="{% url 'empresa:contacto' %}" class="btn btn-primary btn-lg">
                        Contáctanos
                    </a>
                    <a href="{% url 'empresa:servicios' %}" class="btn btn-outline btn-lg">
                        Nuestros Servicios
                    </a>
                </div>
            </div>
            <div class="text-center">
                <div class="relative w-full max-w-xl mx-auto">


                    {% if configuracion and configuracion.logo_svg %}
                        {% render_svg configuracion.logo_svg "mx-auto w-4/5 md:w-[420px] h-auto text-base-content transition-transform duration-300 group-hover:scale-105" %}
                    {% endif %}
                    <div class="w-16 h-16 flex items-center justify-center mx-auto mb-4">
                    {% if site_domain == 'tekon-rl.cl' %}
                    <svg xmlns="http://www.w3.org/2000/svg" fill-rule="evenodd" clip-rule="evenodd" image-rendering="optimizeQuality"
                    shape-rendering="geometricPrecision" text-rendering="geometricPrecision" viewBox="0 0 512 512">
                    <g fill-rule="nonzero">
                        <path fill="#4d4d4d"
                            d="M256 0c70.7 0 134.7 28.7 181 75a255 255 0 0 1 75 181c0 70.7-28.7 134.7-75 181a255 255 0 0 1-181 75 255 255 0 0 1-181-75A255 255 0 0 1 0 256c0-70.7 28.7-134.7 75-181A255 255 0 0 1 256 0" />
                        <path fill="#fff"
                            d="M256 19.6c65.3 0 124.4 26.5 167.2 69.2s69.2 102 69.2 167.2-26.5 124.4-69.2 167.2A236 236 0 0 1 256 492.4a236 236 0 0 1-167.2-69.2c-42.7-42.8-69.2-102-69.2-167.2S46.1 131.6 88.8 88.8A236 236 0 0 1 256 19.6" />
                        <path fill="#d52b1e" d="M471.7 273.8a216.4 216.4 0 0 1-431.4 0z" />
                        <path fill="#0039a6" d="M252.8 273.8H40.3a219 219 0 0 1-.7-17.8A216.4 216.4 0 0 1 252.8 39.6z" />
                        <path fill="#fff" d="m147.7 109.3-13.3 41.1H91l35 25.4-13.4 41.1 35-25.4 35 25.4-13.4-41 35-25.5h-43.2z" />
                    </g>
                </svg>
                {% else %}
                <svg xmlns="http://www.w3.org/2000/svg" fill-rule="evenodd" clip-rule="evenodd" image-rendering="optimizeQuality" shape-rendering="geometricPrecision" text-rendering="geometricPrecision" viewBox="0 0 512 512"><g fill-rule="nonzero"><path fill="#4d4d4d" d="M256 0c70.7 0 134.7 28.7 181 75a255 255 0 0 1 75 181c0 70.7-28.7 134.7-75 181a255 255 0 0 1-181 75 255 255 0 0 1-181-75A255 255 0 0 1 0 256c0-70.7 28.7-134.7 75-181A255 255 0 0 1 256 0"/><path fill="#fff" d="M256 19.6c65.3 0 124.4 26.5 167.2 69.2s69.2 102 69.2 167.2-26.5 124.4-69.2 167.2A236 236 0 0 1 256 492.4a236 236 0 0 1-167.2-69.2c-42.7-42.8-69.2-102-69.2-167.2S46.1 131.6 88.8 88.8A236 236 0 0 1 256 19.6"/><path fill="#007934" d="M459.7 329.3a216.5 216.5 0 0 1-407.4 0z"/><path fill="#f9e300" d="M52.3 329.3h407.4a216 216 0 0 0-.1-146.8H52.4a216 216 0 0 0 0 146.8"/><path fill="#d52b1e" d="M52.4 182.5h407.2a216.5 216.5 0 0 0-407.2 0"/></g></svg>
                {% endif %}
                </div>


                </div>
            </div>
        </div>
    </div>
</section>

<!-- Servicios Destacados -->
<section class="py-20 bg-base-200">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
        <div class="text-center mb-16">
            <h2 class="text-4xl lg:text-5xl font-bold text-base-content mb-6">Nuestros Servicios</h2>
            <div class="w-20 h-1 bg-primary mx-auto mb-6"></div>
            <p class="text-xl text-base-content/70 max-w-3xl mx-auto">
                Ofrecemos soluciones integrales en ingeniería, construcción y supervisión con más de 21 años de experiencia.
            </p>
        </div>
        
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
            {% for servicio in servicios %}
            <div class="card bg-base-100 shadow-lg hover:shadow-xl transition-all duration-300 p-8 text-center group border border-base-300 hover:border-primary/30">
                <div class="w-20 h-20 bg-primary/10 text-primary rounded-full flex items-center justify-center mx-auto mb-6 group-hover:scale-110 group-hover:bg-primary/20 transition-all duration-300">
                    {% if servicio.icono %}
                        {% render_svg servicio.icono "h-12 w-12 sombra" %}
                    {% else %}
                        <i class="fas fa-cogs text-primary text-2xl"></i>
                    {% endif %}
                </div>
                <h3 class="text-xl font-bold text-base-content mb-4 group-hover:text-primary transition-colors duration-300">{{ servicio.nombre }}</h3>
                <p class="text-base-content/70 leading-relaxed">{{ servicio.descripcion|truncatewords:20 }}</p>
            </div>
            {% empty %}
            <div class="col-span-full text-center py-12">
                <div class="w-20 h-20 bg-primary/10 rounded-full flex items-center justify-center mx-auto mb-6">
                    <i class="fas fa-tools text-primary text-3xl"></i>
                </div>
                <p class="text-base-content/70 text-lg">Los servicios se están cargando...</p>
            </div>
            {% endfor %}
        </div>
        
        <div class="text-center mt-12">
            <a href="{% url 'empresa:servicios' %}" class="btn btn-primary btn-lg">
                Ver Todos los Servicios
                <i class="fas fa-arrow-right ml-2"></i>
            </a>
        </div>
    </div>
</section>

<!-- Proyectos Destacados -->
{% if proyectos_destacados %}
<section class="py-20 bg-base-100">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
        <div class="text-center mb-16">
            <h2 class="text-4xl lg:text-5xl font-bold text-base-content mb-6">Proyectos Destacados</h2>
            <div class="w-20 h-1 bg-primary mx-auto mb-6"></div>
            <p class="text-xl text-base-content/70 max-w-3xl mx-auto">
                Algunos de nuestros proyectos más importantes que demuestran nuestra experiencia y calidad.
            </p>
        </div>
        
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
            {% for proyecto in proyectos_destacados %}
            <div class="sombra card bg-base-100 shadow-lg hover:shadow-xl transition-all duration-300 overflow-hidden group border border-base-300 hover:border-primary/30 relative">
                {% if proyecto.imagen %}
                    <div class="h-48 overflow-hidden relative">
                        <img src="{{ proyecto.imagen.url }}" alt="{{ proyecto.nombre }}" class="w-full h-full object-cover group-hover:scale-105 transition-transform duration-300">
                        <div class="absolute inset-0 bg-gradient-to-t from-black/50 to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300"></div>
                    </div>
                {% else %}
                    <div class="h-48 bg-gradient-to-br from-primary/20 to-primary/10 flex items-center justify-center group-hover:from-primary/30 group-hover:to-primary/20 transition-all duration-300">
                        <i class="fas fa-project-diagram text-primary text-4xl"></i>
                    </div>
                {% endif %}
                <div class="card-body p-6">
                    <h3 class="card-title text-base-content mb-3 group-hover:text-primary transition-colors duration-300">{{ proyecto.nombre }}</h3>
                    <p class="text-base-content/70 mb-4">{{ proyecto.descripcion|truncatewords:15 }}</p>
                    <div class="flex items-center justify-between">
                        <span class="text-primary font-semibold text-sm">{{ proyecto.cliente_mostrado }}</span>
                    </div>
                </div>
                <div class="absolute bottom-4 right-4 max-w-[100px]">
                    {% if proyecto.cliente_rel and proyecto.cliente_rel.logo %}
                        <img src="{{ proyecto.cliente_rel.logo.url }}" alt="{{ proyecto.cliente_mostrado }}" class="h-14 w-auto object-contain drop-shadow-lg">
                    {% else %}
                        <div class="px-4 py-2 bg-primary/15 border border-primary/40 rounded-lg shadow-lg">
                            <span class="text-primary font-semibold text-xs uppercase tracking-[0.18em]">{{ proyecto.cliente_mostrado|default:'Cliente' }}</span>
                        </div>
                    {% endif %}
                </div>
            </div>
            {% endfor %}
        </div>
        
        <div class="text-center mt-12">
            <a href="{% url 'empresa:proyectos' %}" class="btn btn-outline btn-lg">
                Todos los Proyectos
                <i class="fas fa-arrow-right ml-2"></i>
            </a>
        </div>
    </div>
</section>
{% endif %}

<!-- Clientes -->
{% if clientes %}
<section class="py-20 bg-base-200">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
        <div class="text-center mb-16">
            <h2 class="text-4xl lg:text-5xl font-bold text-base-content mb-6">Nuestros Clientes</h2>
            <div class="w-20 h-1 bg-primary mx-auto mb-6"></div>
            <p class="text-xl text-base-content/70 max-w-3xl mx-auto">
                Confiamos en la calidad de nuestro trabajo y nuestros clientes lo confirman.
            </p>
        </div>
        
        <div class="logo-slider">
            <div class="logo-track">
                {% for cliente in clientes %}
                <img src="{{ cliente.logo.url }}" alt="{{ cliente.nombre }}" loading="lazy">
                {% endfor %}
            </div>
        </div>
        
        <div class="text-center mt-12">
            <a href="{% url 'empresa:clientes' %}" class="btn btn-outline btn-lg">
                Clientes
                <i class="fas fa-arrow-right ml-2"></i>
            </a>
        </div>
    </div>
</section>
{% endif %}

<!-- Estadísticas -->
<section class="py-20 bg-base-100">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
        <div class="grid grid-cols-2 md:grid-cols-4 gap-8 text-center">
            <div class="stat bg-base-200 rounded-2xl p-6 shadow-lg hover:shadow-xl transition-all duration-300 border border-base-300 hover:border-primary/30">
                <div class="stat-value text-primary text-4xl font-bold">21+</div>
                <div class="stat-title text-base-content/70 font-semibold">Años de Experiencia</div>
            </div>
            <div class="stat bg-base-200 rounded-2xl p-6 shadow-lg hover:shadow-xl transition-all duration-300 border border-base-300 hover:border-primary/30">
                <div class="stat-value text-primary text-4xl font-bold">120+</div>
                <div class="stat-title text-base-content/70 font-semibold">Proyectos Completados</div>
            </div>
            <div class="stat bg-base-200 rounded-2xl p-6 shadow-lg hover:shadow-xl transition-all duration-300 border border-base-300 hover:border-primary/30">
                <div class="stat-value text-primary text-4xl font-bold">50+</div>
                <div class="stat-title text-base-content/70 font-semibold">Clientes Satisfechos</div>
            </div>
            <div class="stat bg-base-200 rounded-2xl p-6 shadow-lg hover:shadow-xl transition-all duration-300 border border-base-300 hover:border-primary/30">
                <div class="stat-value text-primary text-4xl font-bold">3</div>
                <div class="stat-title text-base-content/70 font-semibold">Países en Operación</div>
            </div>
        </div>
    </div>
</section>

<!-- CTA Section -->
<section class="py-20 bg-primary text-primary-content">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-12 items-center">
            <div class="space-y-6">
                <h2 class="text-4xl lg:text-5xl font-bold">¿Listo para tu próximo proyecto?</h2>
                <p class="text-xl text-primary-content/80 leading-relaxed">
                    Contáctanos hoy mismo y descubre cómo podemos ayudarte a alcanzar tus objetivos con soluciones eficientes y profesionales.
                </p>
            </div>
            <div class="text-center lg:text-right">
                <a href="{% url 'empresa:contacto' %}" class="btn btn-secondary btn-lg">
                    Comenzar Ahora
                    <i class="fas fa-arrow-right ml-2"></i>
                </a>
            </div>
        </div>
    </div>
</section>
{% endblock %}
